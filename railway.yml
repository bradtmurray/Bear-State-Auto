services:
  - name: bearstateauto-backend
    source:
      root: ./backend
    envVars:
      - key: PORT
        value: "5000"
      - key: MONGO_URI
        value: "mongodb+srv://<username>:<password>@cluster0.xxxxx.mongodb.net/bearstatedb?retryWrites=true&w=majority"
    ports:
      - port: 5000
        protocol: http

  - name: bearstateauto-frontend
    source:
      root: ./frontend
    buildCommand: "npm run build"
    outputDirectory: "build"
    envVars:
      - key: REACT_APP_API_URL
        fromServices:
          - serviceId: ${{ services.bearstateauto-backend.id }}
            as: "https://{{ domain }}"
    ports:
      - port: 80
        protocol: http
